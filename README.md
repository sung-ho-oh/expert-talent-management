# [학습자료] 구글 앱스 스크립트(GAS) 기반 인재 정보 관리 시스템 구축 가이드

본 프로젝트는 별도의 서버 구축 없이 **Google Workspace(Sheets, Drive)** 환경만을 활용하여 데이터 저장, 이미지 처리, 웹 UI 배포를 구현한 실무용 가이드입니다.

## 프로젝트 개요

* **목적**: 구글 생태계 내 자원을 활용한 비용 효율적인 데이터 관리 도구 제작
* **핵심 타겟**: GAS를 단순 매크로 이상으로 활용하고자 하는 개발자 및 데이터 관리자
* **주요 기능**: 전문가 정보 CRUD(생성·조회·수정), 프로필 사진 업로드 및 렌더링, 보안 접속

---

## 📁 주요 파일

본 프로젝트의 핵심 파일들입니다:

* **[Code.gs](./Code.gs)** - Google Apps Script 서버 사이드 코드
* **[appsscript.json](./appsscript.json)** - 프로젝트 매니페스트 및 OAuth 권한 설정
* **index.html** - 웹 UI 클라이언트 (GAS 에디터에서 직접 생성)

---

## 🛠 실무적 기술 포인트 (Technical Highlights)

### 1. 이미지 렌더링 보안 이슈 해결 (Base64 인코딩)

가장 흔히 발생하는 '이미지 엑박(깨짐)' 현상을 해결하기 위한 설계입니다.

* **배경**: 구글 드라이브의 직접 주소(`uc?id=...`)는 브라우저의 보안 정책(CORS)이나 써드파티 쿠키 차단 환경에서 이미지 호출이 거부되는 경우가 많습니다.
* **해결**: 서버(`Code.gs`)가 드라이브 파일을 바이너리로 읽어 **Base64 문자열**로 변환한 후 클라이언트로 전달합니다.
* **이점**: 외부 보안 정책에 구애받지 않고 어떠한 브라우저 환경에서도 100% 안정적인 이미지 출력을 보장합니다.

### 2. 매니페스트(`appsscript.json`)를 통한 권한 자동화

협업 및 배포 시 발생하는 권한 승인 오류를 최소화합니다.

* **설계**: 프로젝트에 필요한 OAuth 범위를 매니페스트에 명시적으로 선언(`oauthScopes`)하여, 앱 실행 시 필요한 권한을 한 번에 승인받도록 구성했습니다.

---

## 구축 및 실행 가이드

### Step 1. 스프레드시트 생성 및 설정

데이터 저장소 역할을 하는 구글 스프레드시트를 설정합니다.

1. **새 스프레드시트 생성**
   - 구글 드라이브에서 새 스프레드시트를 생성합니다.
   - 시트 이름을 '시트1'로 설정합니다.

2. **헤더 행 구성** (1행에 다음 컬럼명 입력)

   | A | B | C | D | E | F | G | H | I | J |
   |---|---|---|---|---|---|---|---|---|---|
   | 이름 | 생년월일 | 전화번호 | 주소 | 이메일 | 학력 | 경력 | 소속기관명 | 직위 | 소속기관주소 |

   | K | L | M | N | O | P | Q | R | S | T |
   |---|---|---|---|---|---|---|---|---|---|
   | 자격증 | 전문분야 | 활동지역 | 컨설팅실적 | 평가실적 | 강의실적 | 저술실적 | 논문실적 | 사진URL | 동의여부 |

3. **Apps Script 연결**
   - 스프레드시트 메뉴에서 **[확장 프로그램] > [Apps Script]** 클릭
   - 새 프로젝트가 자동으로 해당 스프레드시트와 연결됩니다.
   - `Code.gs`의 내용을 복사하여 붙여넣기합니다.

### Step 2. 구글 드라이브 폴더 연동

프로필 사진을 저장할 전용 폴더를 설정합니다.

1. 구글 드라이브에서 사진 저장용 폴더를 생성합니다.
2. 폴더를 **[링크가 있는 모든 사용자 - 뷰어]**로 공유 설정합니다.
3. 폴더 URL의 ID 값을 복사합니다. (예: `https://drive.google.com/drive/folders/[폴더ID]`)
4. `Code.gs` 상단의 `PHOTO_FOLDER_ID` 변수에 폴더 ID를 할당합니다.

### Step 3. GAS 환경에서 index.html 생성

GAS는 별도의 서버 없이 HTML 파일을 직접 서빙할 수 있습니다.

1. GAS 에디터 왼쪽 `+` 버튼을 눌러 **[HTML]** 파일을 생성합니다.
2. 파일 이름을 `index`로 지정합니다.
3. 웹 UI 코드를 작성합니다. (전문가 정보 입력 폼, 조회 테이블 등)
4. `Code.gs`의 `doGet()` 함수가 `HtmlService`를 통해 이 파일을 로드합니다.

### Step 4. 웹 앱 배포 및 버전 관리

1. **[배포] > [새 배포]**를 통해 웹 앱 URL을 생성합니다.
   - 유형: 웹 앱
   - 다음 사용자로 실행: 나
   - 액세스 권한: 원하는 설정 선택 (모든 사용자 / 조직 내 사용자)
2. **주의**: 코드를 수정한 후에는 반드시 **[배포 관리] > [수정] > [새 버전]**을 선택하여 배포해야 실제 반영됩니다.

---

## 자주 발생하는 오류와 조치 (Troubleshooting)

| 현상 | 원인 | 해결책 |
| --- | --- | --- |
| **사진 조회 불가** | 브라우저 보안 정책에 의한 차단 | 서버단에서 **Base64 변환 후 전송** 로직 확인 |
| **Permission Denied** | 스크립트 실행 권한 미승인 | 에디터에서 함수 직접 실행 후 **권한 검토 및 승인** |
| **수정사항 미반영** | 이전 버전 배포 주소 사용 | 배포 관리에서 **새 버전 발행** 및 URL 확인 |

---

## 개발자의 한마디

> "도구의 한계를 이해하는 것이 개발의 시작입니다. 구글 드라이브가 이미지 호스팅에 최적화되어 있지 않다면, 데이터를 텍스트(Base64)로 변환해 전달하는 방식으로 문제를 해결할 수 있습니다. 주어진 환경 내에서 최선의 우회로를 찾는 과정이 담긴 프로젝트입니다."

---

## 👤 개발자 정보

* **개발자**: sung-ho-oh
* **GitHub**: [sung-ho-oh](https://github.com/sung-ho-oh)
* **LinkedIn**: [sung-ho-oh](https://www.linkedin.com/in/sung-ho-oh-07011152)
* **저장소**: [expert-talent-management](https://github.com/sung-ho-oh/expert-talent-management)
